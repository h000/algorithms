SELECT MONTH(START_DATE) MONTH, c.CAR_ID, count(*) RECORDS
FROM  ( SELECT CAR_ID
        FROM CAR_RENTAL_COMPANY_RENTAL_HISTORY
        WHERE DATE_FORMAT(START_DATE, '%Y-%m') BETWEEN '2022-08' AND '2022-10'
        GROUP BY CAR_ID
        HAVING count(*) >= 5
      ) s
JOIN CAR_RENTAL_COMPANY_RENTAL_HISTORY c ON s.CAR_ID = c.CAR_ID
WHERE DATE_FORMAT(START_DATE, '%Y-%m') BETWEEN '2022-08' AND '2022-10'
GROUP BY MONTH(START_DATE), c.CAR_ID
HAVING RECORDS > 0
ORDER BY MONTH asc, s.CAR_ID desc
